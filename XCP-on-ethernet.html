<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XCP-on-Ethernet 互動式技術解析</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Slate Gray and Sky Blue -->
    <!-- Application Structure Plan: The application is structured as a single-page, scrollable dashboard with a sticky navigation bar. This design allows users to either follow a linear path through the content or jump directly to sections of interest. The structure is thematic, starting with core concepts, moving to a technical deep-dive with interactive tabs, then to visual comparisons of protocols, followed by applications and challenges. This non-linear, thematic structure is chosen over the report's linear format to enhance user engagement and facilitate easier comparison and understanding of complex relationships between different aspects of the protocol. Key interactions include tabbed interfaces, accordions for detailed information, and interactive charts to make data digestible. -->
    <!-- Visualization & Content Choices: 
        - Report Info: Protocol comparison (CAN, FlexRay, Ethernet). Goal: Compare quantitative performance. Viz/Method: Interactive Bar Chart (Chart.js). Interaction: Hover to see exact values. Justification: Bar charts are superior to tables for quick visual comparison of metrics like bandwidth and data load. Library: Chart.js.
        - Report Info: Protocol comparison (UDS, DoIP, SOME/IP). Goal: Compare qualitative roles. Viz/Method: Interactive HTML Grid. Interaction: Hovering highlights rows/columns to understand the protocol's role across different attributes. Justification: An interactive grid is more engaging than a static table for comparing features. Library/Method: HTML/Tailwind/JS.
        - Report Info: Core Principles (Master/Slave, Layered Arch, A2L). Goal: Explain abstract concepts. Viz/Method: Icon-driven card layout. Interaction: Click to expand for details. Justification: Breaks down complex ideas into digestible, visually separated chunks. Library/Method: HTML/Tailwind/JS.
        - Report Info: Technical Details (TCP/UDP, Packets). Goal: Organize dense technical info. Viz/Method: Tabbed interface. Interaction: Click tabs to switch content. Justification: Prevents overwhelming the user by showing only relevant information at one time. Library/Method: HTML/Tailwind/JS.
        - CONFIRMATION: NO SVG graphics used. NO Mermaid JS used.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
            max-height: 50vh;
        }
        .nav-link {
            transition: color 0.3s, border-bottom-color 0.3s;
        }
        .nav-link:hover, .nav-link.active {
            color: #0284c7;
            border-bottom-color: #0284c7;
        }
        .card-flip {
            perspective: 1000px;
        }
        .card-flip-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .card-flip.flipped .card-flip-inner {
            transform: rotateY(180deg);
        }
        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .card-back {
            transform: rotateY(180deg);
            overflow-y: auto;
            justify-content: flex-start;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .tab-button.active {
            background-color: #0284c7;
            color: white;
        }
        html {
            scroll-behavior: smooth;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out;
        }
    </style>
</head>
<body class="bg-slate-50">

    <header id="header" class="bg-white/80 backdrop-blur-md shadow-sm sticky top-0 z-50">
        <nav class="container mx-auto px-6 py-3">
            <div class="flex justify-between items-center">
                <h1 class="text-xl font-bold text-slate-800">XCP-on-Ethernet 解析</h1>
                <div class="hidden md:flex space-x-8">
                    <a href="#intro" class="nav-link text-slate-600 border-b-2 border-transparent pb-1">簡介</a>
                    <a href="#core-principles" class="nav-link text-slate-600 border-b-2 border-transparent pb-1">核心原則</a>
                    <a href="#tech-deep-dive" class="nav-link text-slate-600 border-b-2 border-transparent pb-1">技術剖析</a>
                    <a href="#comparison" class="nav-link text-slate-600 border-b-2 border-transparent pb-1">協議比較</a>
                    <a href="#applications" class="nav-link text-slate-600 border-b-2 border-transparent pb-1">應用場景</a>
                    <a href="#challenges" class="nav-link text-slate-600 border-b-2 border-transparent pb-1">挑戰</a>
                </div>
                <button id="mobile-menu-button" class="md:hidden text-slate-700">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                </button>
            </div>
            <div id="mobile-menu" class="hidden md:hidden mt-4">
                <a href="#intro" class="block py-2 px-4 text-sm text-slate-600 hover:bg-slate-100 rounded">簡介</a>
                <a href="#core-principles" class="block py-2 px-4 text-sm text-slate-600 hover:bg-slate-100 rounded">核心原則</a>
                <a href="#tech-deep-dive" class="block py-2 px-4 text-sm text-slate-600 hover:bg-slate-100 rounded">技術剖析</a>
                <a href="#comparison" class="block py-2 px-4 text-sm text-slate-600 hover:bg-slate-100 rounded">協議比較</a>
                <a href="#applications" class="block py-2 px-4 text-sm text-slate-600 hover:bg-slate-100 rounded">應用場景</a>
                <a href="#challenges" class="block py-2 px-4 text-sm text-slate-600 hover:bg-slate-100 rounded">挑戰</a>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-6 py-8 md:py-12">

        <section id="intro" class="text-center min-h-[60vh] flex flex-col justify-center items-center">
            <h2 class="text-4xl md:text-6xl font-bold text-sky-700 mb-4">XCP on Ethernet</h2>
            <p class="text-xl md:text-2xl text-slate-600 mb-8 max-w-4xl">現代汽車ECU開發的通用測量與校準協議</p>
            <p class="max-w-3xl text-slate-500 leading-relaxed">
                XCP-on-Ethernet 已成為現代汽車嵌入式系統開發不可或缺的協議。它利用乙太網的高頻寬，為ECU的測量、校準、診斷和韌體更新提供了一個高效、統一且可擴展的解決方案，極大地加速了從演算法原型設計到整車測試的開發流程。
            </p>
        </section>

        <section id="core-principles" class="py-16">
            <h2 class="text-3xl font-bold text-center mb-4">三大核心原則</h2>
            <p class="text-center text-slate-500 mb-12 max-w-2xl mx-auto">XCP的設計理念體現在其靈活且強大的架構中，這三大原則是其成功的基石。</p>
            <div class="grid md:grid-cols-3 gap-8">
                <div class="bg-white p-8 rounded-xl shadow-lg text-center transform hover:scale-105 transition-transform">
                    <div class="text-5xl mb-4">👑</div>
                    <h3 class="text-xl font-bold mb-2">主從通訊模型</h3>
                    <p class="text-slate-500">XCP採用單主機/多從機架構，其中主機（如校準工具）對多個從機（ECU）進行集中控制。這種模型尤其適用於現代車輛日益分散和複雜的ECU架構，它提供了一個統一的控制點，便於跨多個互連ECU進行連貫的測量和校準，確保資料一致性和同步操作，對於整體系統優化至關重要。</p>
                </div>
                <div class="bg-white p-8 rounded-xl shadow-lg text-center transform hover:scale-105 transition-transform">
                    <div class="text-5xl mb-4">🧱</div>
                    <h3 class="text-xl font-bold mb-2">協議與傳輸層分離</h3>
                    <p class="text-slate-500">XCP將核心協議邏輯與底層網路（如CAN、FlexRay、乙太網）分離。這使得核心協議在任何通訊匯流排上都保持一致，顯著減少了ECU製造商的實施工作。它確保了在整個開發過程中都能使用相同的機制和工具，減少了工作步驟間的劇變，並降低了工具培訓的需求，提供了卓越的敏捷性。</p>
                </div>
                <div class="bg-white p-8 rounded-xl shadow-lg text-center transform hover:scale-105 transition-transform">
                    <div class="text-5xl mb-4">📄</div>
                    <h3 class="text-xl font-bold mb-2">A2L文件驅動</h3>
                    <p class="text-slate-500">透過ASAM MCD-2 MC標準化的A2L文件，XCP定義了ECU內部變數和參數的屬性及記憶體位址。這從根本上將軟體開發與校準和測量配置分離。工程師只需更新A2L文件和主機工具配置，即可修改參數和採集資料，而無需重新編譯和刷新ECU韌體，顯著加速了演算法優化和系統調優的迭代過程。</p>
                </div>
            </div>
        </section>

        <section id="tech-deep-dive" class="py-16 bg-slate-100 -mx-6 px-6 rounded-2xl">
            <h2 class="text-3xl font-bold text-center mb-4">技術深度剖析</h2>
            <p class="text-center text-slate-500 mb-12 max-w-2xl mx-auto">深入了解XCP-on-Ethernet的內部運作機制，從傳輸協議的選擇到封包的精細結構，這一切都是為了實現高效的汽車ECU開發。</p>
            <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-8">
                <div class="mb-6 border-b border-slate-200 flex justify-center space-x-2 md:space-x-4">
                    <button class="tab-button py-2 px-4 rounded-t-lg font-semibold transition active" data-tab="transport">傳輸協議</button>
                    <button class="tab-button py-2 px-4 rounded-t-lg font-semibold transition" data-tab="packets">封包結構</button>
                    <button class="tab-button py-2 px-4 rounded-t-lg font-semibold transition" data-tab="sync">同步機制</button>
                    <button class="tab-button py-2 px-4 rounded-t-lg font-semibold transition" data-tab="comm-modes">通訊模式</button>
                </div>
                <div id="transport" class="tab-content active">
                    <h3 class="text-xl font-bold mb-4 text-sky-700">TCP vs. UDP：策略性選擇</h3>
                    <p class="text-slate-600 mb-6">XCP-on-Ethernet同時支援TCP/IP和UDP/IP，允許根據不同任務的效能和可靠性需求進行優化，實現網路資源的最高效利用。</p>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="border border-green-200 bg-green-50 p-4 rounded-lg">
                            <h4 class="font-bold text-green-800">TCP/IP (可靠傳輸)</h4>
                            <p class="text-sm text-green-700">提供可靠、面向連接的通訊，具有保證傳遞和流量控制。這對命令響應、參數修改和快閃記憶體編程等不容許任何資料遺失的關鍵操作至關重要，確保資料完整性。</p>
                        </div>
                        <div class="border border-blue-200 bg-blue-50 p-4 rounded-lg">
                            <h4 class="font-bold text-blue-800">UDP/IP (高速傳輸)</h4>
                            <p class="text-sm text-blue-700">提供低開銷、高速度的資料傳輸。通常用於資料採集（DAQ）封包，此時連續的資料流比單個封包的保證送達更重要。這種選擇是策略性的，旨在平衡速度與可靠性。</p>
                        </div>
                    </div>
                </div>
                <div id="packets" class="tab-content">
                    <h3 class="text-xl font-bold mb-4 text-sky-700">CTO & DTO：職責分離的封包結構</h3>
                    <p class="text-slate-600 mb-6">XCP通訊將控制指令和資料流明確分離為兩種類型的封包，以優化各自的處理邏輯和傳輸效率。這種結構獨立於底層傳輸協議。</p>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="border border-purple-200 bg-purple-50 p-4 rounded-lg">
                            <h4 class="font-bold text-purple-800">CTO (命令傳輸物件)</h4>
                            <p class="text-sm text-purple-700">用於主從之間的命令交換，例如發送指令 (CMD)、接收響應 (RES) 或錯誤 (ERR) 以及事件封包 (EV) 和服務請求封包 (SERV)。每個主機發送的 CMD 必須始終由 RES 或 ERR 回應，確保控制邏輯的嚴謹性。</p>
                        </div>
                        <div class="border border-orange-200 bg-orange-50 p-4 rounded-lg">
                            <h4 class="font-bold text-orange-800">DTO (資料傳輸物件)</h4>
                            <p class="text-sm text-orange-700">專門用於交換同步的測量 (DAQ) 和激勵 (STIM) 資料。DTO 封包包含一個識別欄位 (PID)，用於識別 DAQ 列表和 ODT (物件描述表)，以及一個可選的時間戳欄位，其中包含從機在資料傳輸時的內部時鐘值，這對重新排序封包和確保時間相關性至關重要。</p>
                        </div>
                    </div>
                </div>
                <div id="sync" class="tab-content">
                    <h3 class="text-xl font-bold mb-4 text-sky-700">DAQ & STIM：閉環開發的引擎</h3>
                    <p class="text-slate-600 mb-6">DAQ和STIM是XCP的核心功能，它們共同構建了一個強大的閉環開發環境，是實現快速原型和旁路測試的基礎。</p>
                    <div class="space-y-4">
                        <div class="border border-cyan-200 bg-cyan-50 p-4 rounded-lg">
                            <h4 class="font-bold text-cyan-800">DAQ (資料採集)</h4>
                            <p class="text-sm text-cyan-700">資料從從機發送到主機，並與ECU內部事件（如任務執行、計時器訊號）嚴格同步。DAQ 列表（總結測量變數）分配給選定的事件。物件描述表 (ODT) 定義了 RAM 內容如何打包到匯流排幀中。XCP 允許在資料從 ECU 記憶體傳輸到發送緩衝區時對採集到的資料進行時間戳，確保了極高的時間精度。</p>
                        </div>
                        <div class="border border-rose-200 bg-rose-50 p-4 rounded-lg">
                            <h4 class="font-bold text-rose-800">STIM (資料激勵)</h4>
                            <p class="text-sm text-rose-700">資料從主機向從機發送，同樣與從機中的事件同步。這對於向控制單元提供輸入資料非常有用，例如用於旁路演算法或輸入記錄的原始感測器資料。DAQ 和 STIM 的結合促進了旁路，使 ECU 邏輯的一部分可以在 PC 上運行模型，形成閉環開發環境。</p>
                        </div>
                    </div>
                </div>
                <div id="comm-modes" class="tab-content">
                    <h3 class="text-xl font-bold mb-4 text-sky-700">通訊模式：優化資料傳輸</h3>
                    <p class="text-slate-600 mb-6">XCP支援多種通訊模式，旨在針對不同的操作場景優化資料傳輸效率，從而最大化底層乙太網頻寬的利用率。</p>
                    <ul class="list-disc list-inside text-slate-700 space-y-2">
                        <li>
                            <span class="font-bold">標準通訊模式：</span>主機發送請求並等待從機回應。這確保了控制的嚴格請求-回應機制。
                        </li>
                        <li>
                            <span class="font-bold">主機塊傳輸模式（可選）：</span>主機可以連續發送多個命令，無需等待單個回應，顯著加速大資料（如記憶體上傳/下載）的傳輸，透過最小化確認開銷來最大化吞吐量。
                        </li>
                        <li>
                            <span class="font-bold">從機塊傳輸模式：</span>從機可以連續向主機發送多個幀，進一步提高從機到主機方向的資料傳輸效率。
                        </li>
                        <li>
                            <span class="font-bold">交錯通訊模式（可選）：</span>主機可以連續發送多個請求，同時考慮從機的接收緩衝區大小，而從機可以無限制地發送多個回應。此模式不應與塊模式同時使用，它允許並行操作，提高了複雜測量和校準會話中的響應能力。
                        </li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="comparison" class="py-16">
            <h2 class="text-3xl font-bold text-center mb-4">多維度協議比較</h2>
            <p class="text-center text-slate-500 mb-12 max-w-2xl mx-auto">XCP-on-Ethernet並非孤立存在，了解它與其他車用網路協議的關係，才能更好地理解其在現代汽車架構中的獨特定位。</p>
            
            <div class="bg-white p-8 rounded-xl shadow-lg mb-12">
                <h3 class="text-2xl font-bold mb-2 text-center">性能對比：vs. CAN & FlexRay</h3>
                <p class="text-center text-slate-500 mb-8">此圖表展示了乙太網在頻寬和資料負載方面的巨大優勢，這是其能夠處理ADAS和資訊娛樂等大數據量應用的根本原因。</p>
                <div class="chart-container">
                    <canvas id="performanceChart"></canvas>
                </div>
            </div>

            <div class="bg-white p-8 rounded-xl shadow-lg">
                <h3 class="text-2xl font-bold mb-2 text-center">角色定位：vs. UDS, DoIP & SOME/IP</h3>
                <p class="text-center text-slate-500 mb-8">不同的協議在汽車生命週期中扮演不同角色。XCP是開發階段的主力，而其他協議則專注於售後診斷或車輛正常運行的資料交換。</p>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left text-slate-500">
                        <thead class="text-xs text-slate-700 uppercase bg-slate-100">
                            <tr>
                                <th scope="col" class="px-6 py-3 rounded-l-lg">協議</th>
                                <th scope="col" class="px-6 py-3">主要目的</th>
                                <th scope="col" class="px-6 py-3">典型使用階段</th>
                                <th scope="col" class="px-6 py-3 rounded-r-lg">通訊模式</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="bg-white border-b hover:bg-sky-50">
                                <th scope="row" class="px-6 py-4 font-medium text-slate-900 whitespace-nowrap">XCP-on-Ethernet</th>
                                <td class="px-6 py-4">測量、校準、除錯</td>
                                <td class="px-6 py-4">開發階段 (發布前)</td>
                                <td class="px-6 py-4">主從模式</td>
                            </tr>
                            <tr class="bg-white border-b hover:bg-sky-50">
                                <th scope="row" class="px-6 py-4 font-medium text-slate-900 whitespace-nowrap">UDS</th>
                                <td class="px-6 py-4">診斷、韌體更新</td>
                                <td class="px-6 py-4">整個生命週期 (發布後)</td>
                                <td class="px-6 py-4">客戶端-伺服器</td>
                            </tr>
                            <tr class="bg-white border-b hover:bg-sky-50">
                                <th scope="row" class="px-6 py-4 font-medium text-slate-900 whitespace-nowrap">DoIP</th>
                                <td class="px-6 py-4">在IP網路上傳輸UDS</td>
                                <td class="px-6 py-4">發布後 (與UDS結合)</td>
                                <td class="px-6 py-4">閘道器-終端</td>
                            </tr>
                            <tr class="bg-white hover:bg-sky-50">
                                <th scope="row" class="px-6 py-4 font-medium text-slate-900 whitespace-nowrap">SOME/IP</th>
                                <td class="px-6 py-4">服務導向的資料交換</td>
                                <td class="px-6 py-4">正常車輛運行</td>
                                <td class="px-6 py-4">服務導向 (訂閱/通知)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="applications" class="py-16 bg-slate-100 -mx-6 px-6 rounded-2xl">
            <h2 class="text-3xl font-bold text-center mb-4">核心應用場景</h2>
            <p class="text-center text-slate-500 mb-12 max-w-2xl mx-auto">從參數微調到虛擬測試，XCP-on-Ethernet支撐著汽車軟體開發的各個關鍵環節。點擊卡片查看詳細說明。</p>
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
                <div class="card-flip h-64" data-app-id="app1">
                    <div class="card-flip-inner rounded-xl shadow-lg">
                        <div class="card-face card-front bg-white p-6">
                            <div class="text-4xl mb-4">🔧</div>
                            <h3 class="text-xl font-bold">ECU校準與參數化</h3>
                            <p class="text-xs text-slate-400 mt-4">點擊查看詳情</p>
                        </div>
                        <div class="card-face card-back bg-sky-700 text-white p-6">
                            <h3 class="text-lg font-bold mb-2">ECU校準與參數化</h3>
                            <p class="text-sm">工程師可即時調整ECU內部參數（如曲線、映射），觀察系統響應並優化性能，無需重新編譯和刷新韌體，極大加速了演算法的迭代優化過程。</p>
                        </div>
                    </div>
                </div>
                <div class="card-flip h-64" data-app-id="app2">
                    <div class="card-flip-inner rounded-xl shadow-lg">
                        <div class="card-face card-front bg-white p-6">
                            <div class="text-4xl mb-4">📈</div>
                            <h3 class="text-xl font-bold">測量與資料記錄</h3>
                            <p class="text-xs text-slate-400 mt-4">點擊查看詳情</p>
                        </div>
                        <div class="card-face card-back bg-sky-700 text-white p-6">
                            <h3 class="text-lg font-bold mb-2">測量與資料記錄</h3>
                            <p class="text-sm">以與ECU內部事件同步的方式高速記錄大量測量資料，並可整合外部物理感測器資料，形成對車輛行為的全面視圖，對於性能分析和故障診斷至關重要。</p>
                        </div>
                    </div>
                </div>
                <div class="card-flip h-64" data-app-id="app3">
                    <div class="card-flip-inner rounded-xl shadow-lg">
                        <div class="card-face card-front bg-white p-6">
                            <div class="text-4xl mb-4">🔬</div>
                            <h3 class="text-xl font-bold">快速原型與旁路</h3>
                            <p class="text-xs text-slate-400 mt-4">點擊查看詳光</p>
                        </div>
                        <div class="card-face card-back bg-sky-700 text-white p-6">
                            <h3 class="text-lg font-bold mb-2">快速原型與旁路</h3>
                            <p class="text-sm">將部分ECU演算法在PC上執行（旁路），實現快速控制原型(RCP)。工程師可在普通PC上快速迭代和驗證新功能，顯著縮短開發週期並降低硬體成本。</p>
                        </div>
                    </div>
                </div>
                <div class="card-flip h-64" data-app-id="app4">
                    <div class="card-flip-inner rounded-xl shadow-lg">
                        <div class="card-face card-front bg-white p-6">
                            <div class="text-4xl mb-4">💾</div>
                            <h3 class="text-xl font-bold">大容量資料傳輸</h3>
                            <p class="text-xs text-slate-400 mt-4">點擊查看詳情</p>
                        </div>
                        <div class="card-face card-back bg-sky-700 text-white p-6">
                            <h3 class="text-lg font-bold mb-2">大容量資料傳輸</h3>
                            <p class="text-sm">乙太網的高頻寬極大縮短了ECU快閃記憶體編程所需的時間，使得在開發和測試階段頻繁更新韌體成為可能，這對於軟體定義汽車的敏捷開發至關重要。</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="challenges" class="py-16">
            <h2 class="text-3xl font-bold text-center mb-4">挑戰與考量</h2>
            <p class="text-center text-slate-500 mb-12 max-w-2xl mx-auto">儘管功能強大，但在實施XCP-on-Ethernet時，仍需面對網路特性和安全方面的挑戰。</p>
            <div class="max-w-3xl mx-auto space-y-4">
                <div class="bg-white rounded-lg shadow-md">
                    <button class="accordion-toggle w-full flex justify-between items-center p-5 font-semibold text-left">
                        <span>即時性能與確定性</span>
                        <svg class="w-5 h-5 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="accordion-content px-5 pb-5 text-slate-600">
                        <p>標準乙太網本身不具備CAN或FlexRay的時序確定性。網路擁塞、抖動可能影響即時性能。儘管XCP的內部時間戳機制能很大程度緩解此問題，但在對延遲極其敏感的線控系統等應用中，仍需結合時間敏感網路(TSN)等技術來保證嚴格的確定性。</p>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md">
                    <button class="accordion-toggle w-full flex justify-between items-center p-5 font-semibold text-left">
                        <span>網路複雜性與配置</span>
                        <svg class="w-5 h-5 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="accordion-content px-5 pb-5 text-slate-600">
                        <p>現代汽車常採用混合式網路架構，乙太網與CAN、FlexRay等共存，需要複雜的閘道器進行協議轉換。在這種異構網路中配置XCP，需要仔細管理路由、PDU-ID，並確保A2L文件在不同網段間的一致性，對網路架構設計提出了更高要求。</p>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md">
                    <button class="accordion-toggle w-full flex justify-between items-center p-5 font-semibold text-left">
                        <span>安全漏洞</span>
                        <svg class="w-5 h-5 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="accordion-content px-5 pb-5 text-slate-600">
                        <p>XCP提供了對ECU內部的深層次存取，這也擴大了潛在的攻擊面。雖然有「Seed & Key」等基本的安全機制，但仍可能面臨中間人攻擊、資料篡改等風險。因此，XCP功能在開發階段後通常會被停用或移除，並且需要持續演進安全策略以應對不斷變化的網路威脅。</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-slate-800 text-slate-400 text-center p-6">
        <p>&copy; 2024 XCP-on-Ethernet 互動式技術解析。基於公開研究報告生成。</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const performanceData = {
                labels: ['CAN (FD)', 'FlexRay', 'Ethernet'],
                datasets: [{
                    label: '典型頻寬 (Mbps)',
                    data: [8, 10, 100],
                    backgroundColor: 'rgba(59, 130, 246, 0.7)',
                    borderColor: 'rgba(59, 130, 246, 1)',
                    borderWidth: 1,
                    yAxisID: 'y'
                }, {
                    label: '最大資料負載 (Bytes)',
                    data: [64, 254, 1500],
                    backgroundColor: 'rgba(14, 165, 233, 0.7)',
                    borderColor: 'rgba(14, 165, 233, 1)',
                    borderWidth: 1,
                    yAxisID: 'y1'
                }]
            };

            const performanceConfig = {
                type: 'bar',
                data: performanceData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    scales: {
                        y: {
                            type: 'logarithmic',
                            position: 'left',
                            title: {
                                display: true,
                                text: '頻寬 (Mbps, 對數)'
                            }
                        },
                        y1: {
                            type: 'logarithmic',
                            position: 'right',
                            title: {
                                display: true,
                                text: '資料負載 (Bytes, 對數)'
                            },
                            grid: {
                                drawOnChartArea: false,
                            },
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += context.parsed.y + (context.datasetIndex === 0 ? ' Mbps' : ' Bytes');
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            };

            const performanceChartCtx = document.getElementById('performanceChart');
            if(performanceChartCtx) {
                new Chart(performanceChartCtx, performanceConfig);
            }

            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            if(mobileMenuButton && mobileMenu) {
                mobileMenuButton.addEventListener('click', () => {
                    mobileMenu.classList.toggle('hidden');
                });
            }

            const tabs = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    const target = tab.getAttribute('data-tab');
                    tabContents.forEach(content => {
                        content.classList.remove('active');
                        if (content.id === target) {
                            content.classList.add('active');
                        }
                    });
                });
            });

            const cardFlips = document.querySelectorAll('.card-flip');
            cardFlips.forEach(card => {
                card.addEventListener('click', () => {
                    card.classList.toggle('flipped');
                });
            });
            
            const accordionToggles = document.querySelectorAll('.accordion-toggle');
            accordionToggles.forEach(toggle => {
                toggle.addEventListener('click', () => {
                    const content = toggle.nextElementSibling;
                    const svg = toggle.querySelector('svg');
                    
                    if (content.style.maxHeight) {
                        content.style.maxHeight = null;
                        svg.style.transform = 'rotate(0deg)';
                    } else {
                        document.querySelectorAll('.accordion-content').forEach(c => c.style.maxHeight = null);
                        document.querySelectorAll('.accordion-toggle svg').forEach(s => s.style.transform = 'rotate(0deg)');
                        content.style.maxHeight = content.scrollHeight + "px";
                        svg.style.transform = 'rotate(180deg)';
                    }
                });
            });

            const navLinks = document.querySelectorAll('nav a');
            const sections = document.querySelectorAll('main section');
            const headerHeight = document.getElementById('header').offsetHeight;

            window.addEventListener('scroll', () => {
                let current = '';
                sections.forEach(section => {
                    const sectionTop = section.offsetTop - headerHeight - 20;
                    if (pageYOffset >= sectionTop) {
                        current = section.getAttribute('id');
                    }
                });

                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href').includes(current)) {
                        link.classList.add('active');
                    }
                });
            });
        });
    </script>
</body>
</html>
